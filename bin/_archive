#!/bin/zsh


archive()
{

   ROOT=$1
   APP=$2

   APP_REL1="_${ROOT}_${APP}"

   APP_REL=${APP_REL1//[\/-]/_} 

   if [ ! -d "/Users/camilo/archive/$ROOT/$APP.xcarchive" ]; then

      xcodebuild -workspace /Users/camilo/solution/basis/archive/platform-macos/_seed/mac-all.xcworkspace -scheme $APP_REL archive -archivePath /Users/camilo/archive/$ROOT/$APP.xcarchive

   fi

   xcodebuild -exportArchive -archivePath /Users/camilo/archive/$ROOT/$APP.xcarchive -exportPath /Users/camilo/output/$ROOT/ -exportOptionsPlist /Users/camilo/solution/basis/archive/platform-macos/exportOptions.plist

   if [ ! -d $HOME/store/macos/$ROOT ]; then

      mkdir -p "$HOME/store/macos/$ROOT"

   fi

   cd /Users/camilo/output/$ROOT

   zip -FSr $HOME/store/macos/$ROOT/$APP.zip $APP_REL.app

}



